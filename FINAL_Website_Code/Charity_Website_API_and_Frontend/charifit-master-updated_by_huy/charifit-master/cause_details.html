<!doctype html>
<html class="no-js" lang="zxx">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Charifit</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- <link rel="manifest" href="site.webmanifest"> -->
    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.png">
    <!-- Place favicon.ico in the root directory -->

    <!-- CSS here -->
    <link rel="stylesheet" href="css/swiper-bundle.min.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/themify-icons.css">
    <link rel="stylesheet" href="css/nice-select.css">
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/gijgo.css">
    <link rel="stylesheet" href="css/animate.css">
    <link rel="stylesheet" href="css/slicknav.css">
    <link rel="stylesheet" href="css/style.css">
    <!-- <link rel="stylesheet" href="css/responsive.css"> -->
</head>
<style>
    /* Các style hiện có */
    .donation_form_wrapper {
        background-color: #fff;
        border-radius: 10px;
        padding: 40px;
        box-shadow: 0px 0px 20px rgba(0, 0, 0, 0.1);
    }

    .donation_form label {
        font-weight: 600;
        margin-bottom: 8px;
        display: block;
        color: #292929;
    }

    .donation_form .form-control {
        height: 50px;
        border-radius: 5px;
        border: 1px solid #e8e8e8;
        padding: 10px 15px;
        font-size: 16px;
        transition: all 0.3s ease;
    }

    .donation_form .form-control:focus {
        border-color: #F91842;
        box-shadow: 0 0 0 0.2rem rgba(249, 24, 66, 0.25);
    }

    .donation_form button {
        background: #F91842;
        color: #fff;
        border: none;
        height: 60px;
        border-radius: 5px;
        font-size: 18px;
        font-weight: 600;
        padding: 0 45px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .donation_form button:hover {
        background: #d30f36;
    }

    .boxed-btn4 {
        background: #F91842;
        color: #fff;
        display: inline-block;
        padding: 14px 40px;
        font-family: "Quicksand", sans-serif;
        font-size: 18px;
        font-weight: 500;
        border: 0;
        border-radius: 5px;
        text-transform: capitalize;
        cursor: pointer;
        transition: 0.3s;
    }

    .boxed-btn4:hover {
        background: #d30f36;
        color: #fff;
    }

    .donate-btn {
        display: inline-block;
        margin-top: 20px;
        width: 100%;
        text-align: center;
    }

    .section_padding {
        padding: 120px 0;
    }

    .make_donation_area {
        background-color: #f9f9ff;
    }

    @media (max-width: 767px) {
        .donation_form_wrapper {
            padding: 20px;
        }

        .section_padding {
            padding: 60px 0;
        }
    }

    /* Style cho hình tròn trong progress bar */
    .progres_count {
        position: relative;
        z-index: 20;
        /* dùng z-index cao hơn để hiển thị phần tử đè lên trước */
        /* Đảm bảo hình tròn trong progress bar có z-index cao hơn slider */
        background-color: #28a745;
        /* Màu nền xanh */
        color: #fff;
        /* Màu chữ trắng */
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 16px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }

    /* Style cho hình tròn trong slider */
    .image-wrapper {
        position: relative;
        width: 100%;
        z-index: 5;
        /* Đảm bảo container của ảnh và progress-circle có z-index cao */
    }

    /* Đảm bảo Swiper không cắt các phần tử con */
    .swiper,
    .swiper-wrapper {
        overflow: visible !important;
        z-index: 1;
        /* Đảm bảo Swiper có z-index thấp hơn các hình tròn */
    }

    .swiper-slide {
        z-index: 1;
        /* Đảm bảo các slide của Swiper có z-index thấp hơn */
    }

    /* Tùy chỉnh mũi tên điều hướng */
    .swiper-button-next,
    .swiper-button-prev {
        color: #fff;
        /* Màu trắng cho mũi tên */
        background-color: #3CC78F;
        /* Màu nền đỏ (giống theme của bạn) */
        width: 40px;
        /* Kích thước rộng */
        height: 40px;
        /* Kích thước cao */
        border-radius: 50%;
        /* Làm tròn thành hình tròn */
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.3s ease;
        z-index: 15;
        /* Đảm bảo mũi tên đè lên các phần tử khác trong slider */
    }

    .swiper-button-next:hover,
    .swiper-button-prev:hover {
        background-color: #28a745;
        /* Màu nền khi hover */
    }

    /* Đảm bảo biểu tượng mũi tên trong Swiper có màu phù hợp */
    .swiper-button-next::after,
    .swiper-button-prev::after {
        font-size: 18px;
        /* Kích thước biểu tượng mũi tên */
        color: #fff;
        /* Màu trắng cho biểu tượng */
    }
</style>
</style>

<body>
    <!--[if lte IE 9]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
        <![endif]-->


    <!-- header-start -->
    <header>
        <div class="header-area ">
            <div class="header-top_area">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-xl-6 col-md-12 col-lg-8">
                            <div class="short_contact_list">
                                <ul>
                                    <li><a href="#"> <i class="fa fa-phone"></i> +1 (454) 556-5656</a></li>
                                    <li><a href="#"> <i class="fa fa-envelope"></i>Yourmail@gmail.com</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-xl-6 col-md-6 col-lg-4">
                            <div class="social_media_links d-none d-lg-block">
                                <a href="#">
                                    <i class="fa fa-facebook"></i>
                                </a>
                                <a href="#">
                                    <i class="fa fa-pinterest-p"></i>
                                </a>
                                <a href="#">
                                    <i class="fa fa-linkedin"></i>
                                </a>
                                <a href="#">
                                    <i class="fa fa-twitter"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="sticky-header" class="main-header-area">
                <div class="container-fluid">
                    <div class="row align-items-center">
                        <div class="col-xl-3 col-lg-3">
                            <div class="logo">
                                <a href="index.html">
                                    <img src="img/logo.png" alt="">
                                </a>
                            </div>
                        </div>
                        <div class="col-xl-9 col-lg-9">
                            <div class="main-menu">
                                <nav>
                                    <ul id="navigation">
                                        <li><a href="index.html">home</a></li>
                                        <li><a href="About.html">About</a></li>
                                        <li><a href="Cause.html">Campaigns</a></li>
                                        <li><a href="contact.html">Contact</a></li>
                                    </ul>
                                </nav>
                                <div class="Appointment">
                                    <div class="book_btn d-none d-lg-block">
                                        <a href="login.html" id="loginBtn">Login</a>
                                        <a href="login.html" id="logoutBtn" style="display: none;">Logout</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="mobile_menu d-block d-lg-none"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- header-end -->

    <!-- bradcam_area_start  -->
    <div class="bradcam_area breadcam_bg overlay d-flex align-items-center justify-content-center">
        <div class="container">
            <div class="row">
                <div class="col-xl-12">
                    <div class="bradcam_text text-center">
                        <h3>Our Causes</h3>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- bradcam_area_end  -->

    <!-- popular_causes_area_start  -->
    <div class="popular_causes_area pt-120 cause_details">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 col-md-12">
                    <div class="single_cause">
                        <div class="thumb">

                            <div class="swiper mySwiper">
                                <div class="swiper-wrapper" id="image-slider">
                                    <!-- Ảnh sẽ được thêm bằng JavaScript -->
                                </div>
                                <!-- Nút điều hướng -->
                                <div class="swiper-button-next"></div>
                                <div class="swiper-button-prev"></div>
                            </div>
                        </div>
                        <div class="causes_content">
                            <div class="custom_progress_bar">
                                <div class="progress">
                                    <div id="progressBar" class="progress-bar" role="progressbar" style="width: 0%;"
                                        aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                        <span id="progressPercent" class="progres_count">0%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="balance d-flex justify-content-between align-items-center">
                                <span>Raised: <span id="raisedAmount">0</span> VNĐ</span>
                                <span>Goal: <span id="goalAmount">0</span> VNĐ</span>
                            </div>
                            <h4 id="campaignTitle">Loading...</h4>
                            <p id="campaignDescription">Loading...</p>
                            <div class="donate-btn">
                                <button id="donateButton" class="boxed-btn4">Donate Now</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- popular_causes_area_end  -->


    <div id="donation_form_section" class="make_donation_area section_padding" style="display: none;">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="donation_form_wrapper">
                        <h3 class="mb-4 text-center">Gửi ủng hộ của bạn</h3>
                        <form id="donationForm" class="donation_form">
                            <div class="form-group">
                                <label for="d_name">Tên vật quyên góp:</label>
                                <input type="text" id="d_name" name="d_name" class="form-control"
                                    placeholder="Nhập tên vật phẩm" required>
                            </div>

                            <div class="form-group">
                                <label for="d_amount">Số lượng ủng hộ:</label>
                                <input type="number" id="d_amount" name="d_amount" class="form-control"
                                    placeholder="Nhập số lượng" required min="0">
                            </div>

                            <div class="form-group">
                                <label for="d_total_value">Tổng số tiền ủng hộ:</label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">VNĐ</span>
                                    </div>
                                    <input type="number" id="d_total_value" name="d_total_value" class="form-control"
                                        placeholder="Nhập số tiền" required min="0">
                                </div>
                            </div>

                            <div class="form-group mt-4 text-center">
                                <button type="submit" class="boxed-btn4">Gửi ủng hộ ngay</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- footer_start  -->
    <footer class="footer">
        <div class="footer_top">
            <div class="container">
                <div class="row">
                    <div class="col-xl-4 col-md-6 col-lg-4 ">
                        <div class="footer_widget">
                            <div class="footer_logo">
                                <a href="#">
                                    <img src="img/footer_logo.png" alt="">
                                </a>
                            </div>
                            <p class="address_text">Lorem ipsum dolor sit amet, <br> consectetur adipiscing elit, sed do
                                <br> eiusmod tempor incididunt ut labore.
                            </p>
                            <div class="socail_links">
                                <ul>
                                    <li>
                                        <a href="#">
                                            <i class="ti-facebook"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#">
                                            <i class="ti-twitter-alt"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#">
                                            <i class="fa fa-dribbble"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#">
                                            <i class="fa fa-instagram"></i>
                                        </a>
                                    </li>
                                </ul>
                            </div>

                        </div>
                    </div>
                    <div class="col-xl-2 col-md-6 col-lg-2">
                        <div class="footer_widget">
                            <h3 class="footer_title">
                                Services
                            </h3>
                            <ul class="links">
                                <li><a href="#">Donate</a></li>
                                <li><a href="#">Sponsor</a></li>
                                <li><a href="#">Fundraise</a></li>
                                <li><a href="#">Volunteer</a></li>
                                <li><a href="#">Partner</a></li>
                                <li><a href="#">Jobs</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 col-lg-3">
                        <div class="footer_widget">
                            <h3 class="footer_title">
                                Contacts
                            </h3>
                            <div class="contacts">
                                <p>+2(305) 587-3407 <br>
                                    info@loveuscharity.com <br>
                                    Flat 20, Reynolds Neck, North
                                    Helenaville, FV77 8WS
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 col-lg-3">
                        <div class="footer_widget">
                            <h3 class="footer_title">
                                Top News
                            </h3>
                            <ul class="news_links">
                                <li>
                                    <div class="thumb">
                                        <a href="#">
                                            <img src="img/news/news_1.png" alt="">
                                        </a>
                                    </div>
                                    <div class="info">
                                        <a href="#">
                                            <h4>School for African
                                                Childrens</h4>
                                        </a>
                                        <span>Jun 12, 2019</span>
                                    </div>
                                </li>
                                <li>
                                    <div class="thumb">
                                        <a href="#">
                                            <img src="img/news/news_2.png" alt="">
                                        </a>
                                    </div>
                                    <div class="info">
                                        <a href="#">
                                            <h4>School for African
                                                Childrens</h4>
                                        </a>
                                        <span>Jun 12, 2019</span>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="copy-right_text">
            <div class="container">
                <div class="row">
                    <div class="bordered_1px "></div>
                    <div class="col-xl-12">
                        <p class="copy_right text-center">
                        <p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                            Copyright &copy;
                            <script>document.write(new Date().getFullYear());</script> All rights reserved | This
                            template is made with <i class="ti-heart" aria-hidden="true"></i> by <a
                                href="https://colorlib.com" target="_blank">Colorlib</a>
                            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                        </p>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- footer_end  -->

    <!-- link that opens popup -->

    <!-- JS here -->
    <script src="js/swiper-bundle.min.js"></script>
    <script src="js/vendor/modernizr-3.5.0.min.js"></script>
    <script src="js/vendor/jquery-1.12.4.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/isotope.pkgd.min.js"></script>
    <script src="js/ajax-form.js"></script>
    <script src="js/waypoints.min.js"></script>
    <script src="js/jquery.counterup.min.js"></script>
    <script src="js/imagesloaded.pkgd.min.js"></script>
    <script src="js/scrollIt.js"></script>
    <script src="js/jquery.scrollUp.min.js"></script>
    <script src="js/wow.min.js"></script>
    <script src="js/nice-select.min.js"></script>
    <script src="js/jquery.slicknav.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="js/gijgo.min.js"></script>
    <!--contact js-->
    <script src="js/contact.js"></script>
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/jquery.form.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/mail-script.js"></script>

    <script src="js/main.js"></script>
    <script src="js/hidenseek.js"></script>
    <script src="js/SwiperCarousel.js"></script>
    <script>
        const campaignUrl = 'http://vanesline.runasp.net/api/Campaign/GetbyID';
        const donationUrl = 'http://vanesline.runasp.net/Donation/Insert';

        document.addEventListener("DOMContentLoaded", () => {
            const urlParams = new URLSearchParams(window.location.search);
            const campaignId = urlParams.get('id');
            const userData = JSON.parse(localStorage.getItem("userData"));
            const isLoggedIn = userData && userData.userId;

            // Update login/logout buttons and donation form visibility
            const updateLoginButtons = (isLoggedIn) => {
                const loginBtn = document.getElementById("loginBtn");
                const logoutBtn = document.getElementById("logoutBtn");
                const donationFormSection = document.getElementById("donation_form_section");
                const donateButton = document.getElementById("donateButton");

                loginBtn.style.display = isLoggedIn ? "none" : "block";
                logoutBtn.style.display = isLoggedIn ? "block" : "none";
                donationFormSection.style.display = isLoggedIn ? "block" : "none";
                donateButton.style.display = isLoggedIn ? "none" : "block";
            };

            updateLoginButtons(isLoggedIn);

            // Handle donate button click
            document.getElementById("donateButton").addEventListener("click", () => {
                window.alert("Vui lòng đăng nhập để ủng hộ.");
                window.location.href = `login.html?returnUrl=${encodeURIComponent(window.location.href)}`;
            });

            // Handle donation form submission
            document.getElementById("donationForm").addEventListener("submit", (event) => {
                event.preventDefault();
                if (!campaignId || !isLoggedIn) return alert(campaignId ? "Vui lòng đăng nhập để ủng hộ." : "Không tìm thấy ID chiến dịch.");

                const d_donation_id = "D" + Math.random().toString(36).substr(2, 9).toUpperCase();
                const d_name = document.getElementById("d_name").value;
                const d_amount = parseFloat(document.getElementById("d_amount").value);
                const d_total_value = parseFloat(document.getElementById("d_total_value").value);
                const queryString = `?d_donation_id=${encodeURIComponent(d_donation_id)}&d_user_id=${encodeURIComponent(userData.userId)}&d_campaign_id=${encodeURIComponent(campaignId)}&d_name=${encodeURIComponent(d_name)}&d_amount=${d_amount}&d_total_value=${d_total_value}`;

                fetch(`${donationUrl}${queryString}`, { method: "POST" })
                    .then(res => res.text())
                    .then(result => {
                        alert(result);
                        document.getElementById("donationForm").reset();
                        loadCampaignDetails(campaignId);
                    })
                    .catch(err => {
                        console.error("Lỗi khi gửi ủng hộ:", err);
                        alert("Lỗi khi gửi ủng hộ.");
                    });
            });

            // Handle logout
            document.getElementById("logoutBtn").addEventListener("click", (e) => {
                e.preventDefault();
                localStorage.removeItem("userData");
                updateLoginButtons(false);
                alert("Đã đăng xuất thành công!");
            });

            // Load campaign details
            if (!campaignId) return alert("Không tìm thấy ID chiến dịch.");
            loadCampaignDetails(campaignId);

            function loadCampaignDetails(id) {
                fetch(`${campaignUrl}?id=${id}`)
                    .then(res => {
                        if (!res.ok) throw new Error(`Lỗi API: ${res.statusText}`);
                        return res.json();
                    })
                    .then(campaign => {
                        if (!campaign) return alert("Không tìm thấy dữ liệu chiến dịch.");

                        // Update campaign details
                        document.getElementById("campaignTitle").innerText = campaign.cTitle || "Không có tiêu đề";
                        document.getElementById("campaignDescription").innerText = campaign.cDescription || "Không có mô tả";
                        const raised = campaign.cCollectedAmount || 0;
                        const goal = campaign.cGoalAmount || 1;
                        const progress = (raised / goal) * 100;

                        document.getElementById("raisedAmount").innerText = raised.toLocaleString();
                        document.getElementById("goalAmount").innerText = goal.toLocaleString();
                        document.getElementById("progressBar").style.width = `${progress}%`;
                        document.getElementById("progressBar").setAttribute("aria-valuenow", progress);
                        document.getElementById("progressPercent").innerText = `${Math.round(progress)}%`;

                        // Load images into slider
                        const slider = document.getElementById("image-slider");
                        slider.innerHTML = "";
                        const mediaList = campaign.media || [];
                        if (mediaList.length > 0) {
                            mediaList.forEach(media => {
                                const slide = document.createElement("div");
                                slide.className = "swiper-slide";
                                slide.innerHTML = `<img src="${media.mMediaUrl}" alt="Campaign Image" style="width: 100%; border-radius: 10px;">`;
                                slider.appendChild(slide);
                            });
                            new Swiper(".mySwiper", {
                                navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" },
                                loop: true,
                                autoplay: { delay: 3000, disableOnInteraction: false }
                            });
                        } else {
                            slider.innerHTML = `<div class="swiper-slide"><img src="img/causes/large_img.png" alt="No image" style="width: 100%; border-radius: 10px;"></div>`;
                        }
                    })
                    .catch(err => {
                        console.error("Lỗi khi tải dữ liệu chiến dịch:", err);
                        alert("Lỗi khi tải dữ liệu chiến dịch.");
                    });
            }
        });
    </script>
    <script src="js/hidenseek.js"></script>
</body>

</html>